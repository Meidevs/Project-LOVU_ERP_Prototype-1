<!DOCTYPE html>
<html>
    <head>
        <script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous"></script>
    </head>
    <body>
        <h1>금일 입고 제품을 기입해주세요</h1>
        <p>
            입고 제품 리스트
        </p>
        <div>
            <p>
                입고 일자 : <div id='date'>
            </p>
        </div>

        <!-- <div>
            품목 : 
        </div>
        <div class='dropdown'>
            <button onclick="dropdown()" class='dropBtn'>품목 조회</button>
            <div id='dropdown_itemList' class='dropdown-content'>
                <input type='text' placeholder='상품 이름 검색' id='itemName' onkeyup="filterFunction()">
                <div id='itemList'></div>
            </div>

        </div> -->

        <p>
            <button type='button' id='addBtn' name='addBtn' onClick='addOrderList()'>상품 추가</button>
            <button type='button' id='deleteBtn' name='deleteBtn' onClick='deleteOrderList()'>상품 제거</button>
        </p>
        <div>
            <table width='1500px'>
                <tr>
                    <td>No.</td>
                    <td>일자</td>
                    <td>품목</td>
                    <td>용량</td>
                    <td>수량</td>
                    <td>금액</td>
                    <td>요청자</td>
                    <td>구분</td>
                    <td>결제수단</td>
                    <td>반품자</td>
                    <td>비고</td>
                </tr>
                <tbody id='tblShow'>

                </tbody>
            </table>
        </div>
    </body>
    <script>
        var count = 0;
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        var today = year + '/' + month + '/' + day;
        console.log(today)

        var date = document.getElementById('date');
        date.innerHTML = today;

        $(document).ready( async () => {
            const response = await fetch ('http://localhost:3000/getItemsList', {
                method: 'GET',
                headers : {
                    'Content-Type': 'application/json'
                }
            })
            var json = await response.json();
            if (response.ok) {
                var itemList = document.getElementById('itemList');
                
                for(var i = 0; i < json.length; i ++) {
                    var ul = document.createElement('ul');
                    var textNode = document.createTextNode(json[i]);
                    ul.appendChild(textNode);
                    document.getElementById('itemList').appendChild(ul)
                }
            }
        })
        addOrderList = () => {
            count++;
            var objRow;
            objRow = document.all('tblShow').insertRow();

            //No.
            var objCell_Num = objRow.insertCell();
            objCell_Num.innerHTML = count;

            //Product Supply Date
            var objCell_Date = objRow.insertCell();
            objCell_Date.innerHTML = today;

            //Product Name
            var objCell_Name = objRow.insertCell();
            objCell_Name.innerHTML = "<input type='text' id='row_nm' name='row_nm' value=''/>";

            //Product Capacity(Volume)
            var objCell_Cp = objRow.insertCell();
            objCell_Cp.innerHTML = "<input type='text' id='row_cp' name='row_cp' value=''/>";

            //Product Count
            var objCell_Cnt= objRow.insertCell();
            objCell_Cnt.innerHTML = "<input type='text' id='row_cnt' name='row_cnt' value=''/>";
            
            //Price
            var objCell_Price= objRow.insertCell();
            objCell_Price.innerHTML = "<input type='text' id='row_price' name='row_price' value=''/>";

            //Requestor
            var objCell_Rt= objRow.insertCell();
            objCell_Rt.innerHTML = "<input type='text' id='row_rt' name='row_rt' value=''/>";

            //Supply Purpose (Distinct)
            var objCell_Dnt = objRow.insertCell();
            objCell_Dnt.innerHTML = 
                "반품<input type='radio' id='row_dnt' name='row_dnt' value='반품'/>" + 
                "본사<input type='radio' id='row_dnt' name='row_dnt' value='본사'/>" + 
                "기타<input type='radio' id='row_dnt' name='row_dnt' value='기타'/>";

            //Payment
            var objCell_Pmt = objRow.insertCell();
            objCell_Pmt.innerHTML = 
                "현금<input type='radio' id='row_pmt' name='row_pmt' value=''/>" + 
                "카드<input type='radio' id='row_pmt' name='row_pmt' value=''/>" +
                "외상<input type='radio' id='row_pmt' name='row_pmt' value=''/>";

            //Supplier
            var objCell_Sup = objRow.insertCell();
            objCell_Sup.innerHTML = "<input type='text' id='row_sup' name='row_sup' value=''/>";

            //Note
            var objCell_Void = objRow.insertCell();
            objCell_Void.innerHTML = "<input type='text' id='row_void' name='row_void' value=''/>";
        }
        deleteOrderList = () => {
            count--;
            var tblContent = document.getElementById('tblShow');
            //If There is no Data at all, Do Nothing.
            if (tblContent.rows.length < 1) return;

            //Delete From Last Table
            tblContent.deleteRow(tblContent.rows.length-1);
        }
        //Dropdown Item Call Function
        // dropdown = () => {
        //     document.getElementById('dropdown_itemList').classList.toggle('show');
        // }

        // filterFunction = () => {
        //     var input, filter, ul, li, a, i;
        //     input = document.getElementById('itemName');
        //     filter = input.value;
        //     div = document.getElementById('dropdown_itemList');
        //     a = div.getElementsByTagName('ul');
        //     console.log(a[0].textContent)
        //     for (i=0; i < a.length; i++) {
        //         txtValue = a[i].textContent || a[i].innerText;
        //         console.log(txtValue.indexOf(filter))
        //         if (txtValue.indexOf(filter) > -1) {
        //             a[i].style.display = "";
        //         } else {
        //             a[i].style.display = "none";
        //         }
        //     }
        // }
    </script>
    <style>
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f6f6f6;
        min-width: 230px;
        overflow: auto;
        border: 1px solid #ddd;
        z-index: 1;
    }
    .show {
        display: block;
    }
    </style>
</html>